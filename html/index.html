<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>From Zero to LOUD - AI Fashion Creator</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

        body {
            font-family: 'Montserrat', sans-serif;
            line-height: 1.6;
            margin: 0;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%); /* Purple-blue gradient */
            color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            max-width: 900px;
            width: 100%;
            margin: auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        h1 {
            text-align: center;
            color: #fff;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }
        h2 {
            color: #a7e9ff;
            border-bottom: 2px solid rgba(167, 233, 255, 0.5);
            padding-bottom: 10px;
            margin-top: 30px;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
        }
        .button {
            background-color: #00bcd4; /* Cyan tone */
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease, transform 0.2s ease;
            display: block;
            width: fit-content;
            margin-top: 20px;
        }
        .button:hover {
            background-color: #0097a7;
            transform: translateY(-2px);
        }
        .trend-feed {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background-color: rgba(0,0,0,0.2);
            border-radius: 10px;
        }
        .trend-item {
            display: flex;
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            overflow: hidden;
            width: 100%;
            max-width: 600px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s ease;
        }
        .trend-item:hover {
            transform: translateY(-5px);
        }
        .trend-item img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 10px 0 0 10px;
        }
        .trend-info {
            padding: 15px;
            flex-grow: 1;
        }
        .trend-info h3 {
            margin-top: 0;
            color: #fff;
            font-size: 1.3em;
        }
        .trend-info p {
            font-size: 0.9em;
            color: #c0f2ff;
        }
        input[type="text"], select {
            width: calc(100% - 22px);
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background-color: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1em;
        }
        input[type="text"]::placeholder {
            color: #c0f2ff;
        }
        .output-console {
            background-color: rgba(0, 0, 0, 0.5);
            color: #00ff00;
            padding: 15px;
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 20px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.85em;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>From Zero to LOUD - AI Fashion Creator</h1>

        <div class="section">
            <h2>구글 간편 로그인</h2>
            <p>소셜 로그인(Google) 기능을 위한 UI 요소가 여기에 들어갑니다.</p>
            <button class="button">Google 로그인</button>
        </div>

        <div class="section">
            <h2>오늘의 트렌드 의상 피드</h2>
            <p>SSENSE 매거진 스타일의 최신 트렌드를 확인하세요.</p>
            <div class="trend-feed" id="trendFeed">
                <!-- 트렌드 의상 이미지 및 설명이 여기에 동적으로 로드됩니다. -->
                <p style="text-align: center; color: #c0f2ff;">트렌드 데이터를 불러오는 중...</p>
            </div>
        </div>

        <div class="section">
            <h2>나만의 코디 생성하기</h2>
            <p>원하는 스타일과 결과물 타입을 선택하여 AI 코디를 생성해보세요!</p>
            <input type="text" id="userPrompt" placeholder="예: 시크하게, 캐주얼하게, 파티룩으로 연출해 줘...">
            <select id="outputType">
                <option value="4cut">4컷 이미지</option>
                <option value="24s_video">24초 영상</option>
            </select>
            <input type="text" id="userUid" placeholder="사용자 UID (구글 로그인 시 자동 입력)">
            <input type="hidden" id="selectedTrendId" value="1"> <!-- 기본값 1 -->
            <button class="button" id="generateContentButton">나만의 코디 생성하러 가기</button>
        </div>

        <div class="section">
            <h2>결과물 콘솔</h2>
            <div class="output-console" id="outputConsole">
                API 응답이 여기에 표시됩니다.
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = "http://localhost:3500/api"; // FastAPI 백엔드 URL

        document.addEventListener('DOMContentLoaded', () => {
            loadTrendData();

            const generateContentButton = document.getElementById('generateContentButton');
            generateContentButton.addEventListener('click', generateContent);
        });

        async function loadTrendData() {
            const trendFeed = document.getElementById('trendFeed');
            trendFeed.innerHTML = '<p style="text-align: center; color: #c0f2ff;">트렌드 데이터를 불러오는 중...</p>';

            // Mocking trend data for now, as FastAPI's DB integration is a placeholder
            // In a real scenario, you'd fetch this from a FastAPI endpoint like /api/trends
            const mockTrends = [
                {
                    trend_id: "1",
                    outfit_name: "버블 헴 드레스",
                    keywords: "#Volume #BubbleHem #Sculptural",
                    image_url: "https://via.placeholder.com/150/6a11cb/ffffff?text=Trend1"
                },
                {
                    trend_id: "2",
                    outfit_name: "오버사이즈 블레이저",
                    keywords: "#Oversized #Tailoring #Androgynous",
                    image_url: "https://via.placeholder.com/150/2575fc/ffffff?text=Trend2"
                }
            ];

            if (mockTrends.length > 0) {
                trendFeed.innerHTML = ''; // Clear loading message
                mockTrends.forEach(trend => {
                    const trendItem = document.createElement('div');
                    trendItem.classList.add('trend-item');
                    trendItem.innerHTML = `
                        <img src="${trend.image_url}" alt="${trend.outfit_name}">
                        <div class="trend-info">
                            <h3>${trend.outfit_name}</h3>
                            <p>${trend.keywords}</p>
                            <button class="button select-trend-button" data-trend-id="${trend.trend_id}">이 트렌드 선택</button>
                        </div>
                    `;
                    trendFeed.appendChild(trendItem);
                });

                document.querySelectorAll('.select-trend-button').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const selectedTrendId = event.target.dataset.trendId;
                        document.getElementById('selectedTrendId').value = selectedTrendId;
                        logToConsole(`트렌드 ID ${selectedTrendId} 선택됨.`);
                    });
                });

                // Automatically select the first trend as default if no selection is made
                document.getElementById('selectedTrendId').value = mockTrends[0].trend_id;

            } else {
                trendFeed.innerHTML = '<p style="text-align: center; color: #e0e0e0;">현재 표시할 트렌드 데이터가 없습니다.</p>';
            }
        }

        async function generateContent() {
            const userPrompt = document.getElementById('userPrompt').value;
            const outputType = document.getElementById('outputType').value;
            const userUid = document.getElementById('userUid').value || 'test_user_123'; // Default for testing
            const selectedTrendId = document.getElementById('selectedTrendId').value;

            if (!userPrompt || !selectedTrendId) {
                logToConsole('오류: 사용자 프롬프트와 트렌드 선택은 필수입니다.', 'error');
                return;
            }

            logToConsole('콘텐츠 생성 요청 중...');

            try {
                const response = await fetch(`${API_BASE_URL}/generate-content`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        trend_id: selectedTrendId,
                        user_prompt: userPrompt,
                        output_type: outputType,
                        user_uid: userUid
                    }),
                });

                const result = await response.json();
                if (response.ok) {
                    logToConsole('요청 성공: ' + JSON.stringify(result, null, 2), 'success');
                } else {
                    logToConsole('요청 실패: ' + JSON.stringify(result, null, 2), 'error');
                }
            } catch (error) {
                logToConsole('API 호출 중 오류 발생: ' + error.message, 'error');
            }
        }

        function logToConsole(message, type = 'info') {
            const outputConsole = document.getElementById('outputConsole');
            const messageElement = document.createElement('p');
            messageElement.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            if (type === 'error') {
                messageElement.style.color = '#ff6b6b';
            } else if (type === 'success') {
                messageElement.style.color = '#6bff6b';
            } else {
                messageElement.style.color = '#00ff00';
            }
            outputConsole.prepend(messageElement); // Add to top
            // Limit console size
            if (outputConsole.children.length > 10) {
                outputConsole.removeChild(outputConsole.lastChild);
            }
        }

        // 초기 로딩 시 트렌드 ID가 선택되도록 함
        // 이 부분은 loadTrendData에서 처리됩니다.
    </script>
</body>
</html>